2025-07-28 05:05:21,124 - INFO - ğŸš€ Starting CLIP Reproduction with BLIP3-o DiT
2025-07-28 05:05:21,127 - INFO - ================================================================================
2025-07-28 05:05:21,127 - INFO - EXPERIMENT DETAILS:
2025-07-28 05:05:21,127 - INFO -   ğŸ“‹ Task: Reproduce clean CLIP embeddings from EVA embeddings
2025-07-28 05:05:21,127 - INFO -   ğŸ§  Model: BLIP3-o DiT with advanced architecture features
2025-07-28 05:05:21,127 - INFO -   ğŸ¯ Target: CLIP embeddings [B, N, 1024]
2025-07-28 05:05:21,127 - INFO -   ğŸ® Conditioning: EVA embeddings [B, N, 4096]
2025-07-28 05:05:21,127 - INFO -   ğŸŒŠ Method: Rectified Flow Matching
2025-07-28 05:05:21,127 - INFO -   ğŸš« Normalization: MINIMAL (only for evaluation similarity)
2025-07-28 05:05:21,127 - INFO - ================================================================================
2025-07-28 05:05:21,127 - INFO - ğŸ—ï¸ BLIP3-o ARCHITECTURE FEATURES:
2025-07-28 05:05:21,127 - INFO -   ğŸŒ 3D Rotary Position Embedding: âœ… ENABLED
2025-07-28 05:05:21,127 - INFO -   ğŸ¥ª Sandwich Normalization: âœ… ENABLED
2025-07-28 05:05:21,127 - INFO -   ğŸ” Grouped-Query Attention: âœ… ENABLED
2025-07-28 05:05:21,127 - INFO -   ğŸ“Š WandB Logging: âœ… ENABLED
2025-07-28 05:05:21,127 - INFO - ================================================================================
2025-07-28 05:05:21,127 - INFO - ğŸ“„ Updated file structure:
2025-07-28 05:05:21,127 - INFO -   â€¢ Model: blip3o_dit.py (âœ… 3D RoPE + Sandwich Norm)
2025-07-28 05:05:21,127 - INFO -   â€¢ Loss: blip3o_fm_loss.py
2025-07-28 05:05:21,127 - INFO -   â€¢ Dataset: blip3o_datasets.py
2025-07-28 05:05:21,127 - INFO -   â€¢ Trainer: blip3o_trainer.py (âœ… WandB Integration)
2025-07-28 05:05:21,127 - INFO -   â€¢ Config: blip3o_config.py
2025-07-28 05:05:21,127 - INFO - ================================================================================
2025-07-28 05:05:21,127 - INFO - Configuration:
2025-07-28 05:05:21,127 - INFO -   Model size: base
2025-07-28 05:05:21,128 - INFO -   Training mode: patch_only
2025-07-28 05:05:21,128 - INFO -   Embeddings dir: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-07-28 05:05:21,128 - INFO -   Output dir: ./checkpoints/clip_repro_20250728_050519
2025-07-28 05:05:21,128 - INFO -   Learning rate: 0.0005
2025-07-28 05:05:21,128 - INFO -   Batch size: 16
2025-07-28 05:05:21,128 - INFO -   Epochs: 10
2025-07-28 05:05:21,128 - INFO -   Max shards: 2
2025-07-28 05:05:21,128 - INFO -   ğŸ§ª OVERFITTING TEST: 20 samples
2025-07-28 05:05:21,128 - INFO -   Debug mode: False
2025-07-28 05:05:21,128 - INFO -   ğŸ“Š WandB project: blip3o-clip-reproduction
2025-07-28 05:05:21,128 - INFO - ================================================================================
2025-07-28 05:05:21,128 - INFO - ğŸ” Checking module availability...
2025-07-28 05:05:24,433 - INFO - âœ… CLIP DiT model loaded from src/modules/models/blip3o_dit.py
2025-07-28 05:05:24,435 - INFO - âœ… Flow matching loss loaded from src/modules/losses/blip3o_fm_loss.py
2025-07-28 05:05:25,252 - INFO - âœ… CLIP trainer loaded from src/modules/trainers/blip3o_trainer.py
2025-07-28 05:05:25,253 - INFO - âœ… CLIP datasets loaded from src/modules/datasets/blip3o_dataset.py
2025-07-28 05:05:25,255 - INFO - âœ… Configuration loaded from src/modules/config/blip3o_config.py
2025-07-28 05:05:25,256 - INFO - ğŸ‰ All CLIP reproduction components loaded successfully!
2025-07-28 05:05:25,256 - INFO - ğŸ‰ BLIP3-o CLIP reproduction modules fully initialized!
2025-07-28 05:05:25,256 - INFO - ğŸš« Using minimal normalization approach
2025-07-28 05:05:25,256 - INFO - ğŸ¯ Ready for EVA â†’ CLIP reproduction training
2025-07-28 05:05:25,256 - INFO - âœ… Using comprehensive modules system
2025-07-28 05:05:25,256 - INFO - ğŸ‰ All CLIP reproduction components loaded successfully!
2025-07-28 05:05:25,256 - INFO - ğŸ‰ All CLIP reproduction components loaded successfully!
2025-07-28 05:05:25,256 - INFO - âœ… Imported config from src.modules
2025-07-28 05:05:25,494 - INFO - Using GPU: NVIDIA H100
2025-07-28 05:05:25,494 - INFO - GPU Memory: 100.0 GB
2025-07-28 05:05:25,494 - INFO - ğŸ—ï¸ BLIP3-o Architecture Configuration:
2025-07-28 05:05:25,494 - INFO -   3D Rotary Position Embedding: âœ… Enabled
2025-07-28 05:05:25,494 - INFO -   Sandwich Normalization: âœ… Enabled
2025-07-28 05:05:25,495 - WARNING - Failed to import from blip3o_dit.py: No module named 'blip3o_dit'
2025-07-28 05:05:25,495 - INFO - âœ… Imported model from src.modules
2025-07-28 05:05:27,534 - INFO - BLIP3-o CLIP DiT model initialized with 249,339,136 parameters
2025-07-28 05:05:27,534 - INFO -   3D RoPE: True
2025-07-28 05:05:27,534 - INFO -   Sandwich Normalization: True
2025-07-28 05:05:27,534 - INFO -   Grid size: 16x16
2025-07-28 05:05:27,534 - INFO -   Hidden size: 768
2025-07-28 05:05:27,534 - INFO -   CLIP size: 1024
2025-07-28 05:05:27,534 - INFO - Creating base model for patch_only mode...
2025-07-28 05:05:27,800 - INFO - Model created with 249,339,136 parameters
2025-07-28 05:05:27,800 - INFO - Model moved to cuda
2025-07-28 05:05:27,800 - INFO - ğŸ” Architecture Validation:
2025-07-28 05:05:27,800 - INFO -   3D RoPE: âœ…
2025-07-28 05:05:27,800 - INFO -   Sandwich Norm: âœ…
2025-07-28 05:05:27,800 - INFO -   Grid Size: 16x16
2025-07-28 05:05:27,800 - INFO -   Grouped-Query Attention: 12/4
2025-07-28 05:05:27,801 - WARNING - Failed to import from blip3o_fm_loss.py: No module named 'blip3o_fm_loss'
2025-07-28 05:05:27,801 - INFO - âœ… Imported loss from src.modules
2025-07-28 05:05:27,801 - INFO - CLIP Flow Matching Loss initialized:
2025-07-28 05:05:27,801 - INFO -   Prediction type: velocity
2025-07-28 05:05:27,801 - INFO -   Flow type: rectified
2025-07-28 05:05:27,801 - INFO -   Loss weight: 1.0
2025-07-28 05:05:27,801 - INFO -   Debug mode: False
2025-07-28 05:05:27,801 - INFO - Flow matching loss created
2025-07-28 05:05:27,801 - WARNING - Failed to import from blip3o_datasets.py: No module named 'blip3o_datasets'
2025-07-28 05:05:27,801 - INFO - âœ… Imported dataset from src.modules
2025-07-28 05:05:27,801 - INFO - Creating CLIP reproduction dataloaders:
2025-07-28 05:05:27,801 - INFO -   Target: CLIP embeddings [B, N, 1024]
2025-07-28 05:05:27,801 - INFO -   Conditioning: EVA embeddings [B, N, 4096]
2025-07-28 05:05:27,801 - INFO -   Normalize: False
2025-07-28 05:05:27,802 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-07-28 05:05:27,802 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-07-28 05:05:27,803 - INFO - Prepared 2 shard files
2025-07-28 05:05:27,803 - INFO - Using manifest for length estimation: 5,219 samples
2025-07-28 05:05:27,803 - INFO - CLIP Reproduction Dataset initialized:
2025-07-28 05:05:27,803 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-07-28 05:05:27,803 - INFO -   Mode: patch_only (256 tokens)
2025-07-28 05:05:27,803 - INFO -   TARGET: CLIP embeddings [B, N, 1024]
2025-07-28 05:05:27,803 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-07-28 05:05:27,803 - INFO -   Normalize: False
2025-07-28 05:05:27,803 - INFO -   Shards: 2
2025-07-28 05:05:27,803 - INFO -   Estimated samples: 5,219
2025-07-28 05:05:27,804 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-07-28 05:05:27,804 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-07-28 05:05:27,804 - INFO - Prepared 2 shard files
2025-07-28 05:05:27,804 - INFO - Using manifest for length estimation: 5,219 samples
2025-07-28 05:05:27,804 - INFO - CLIP Reproduction Dataset initialized:
2025-07-28 05:05:27,804 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-07-28 05:05:27,804 - INFO -   Mode: patch_only (256 tokens)
2025-07-28 05:05:27,804 - INFO -   TARGET: CLIP embeddings [B, N, 1024]
2025-07-28 05:05:27,804 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-07-28 05:05:27,804 - INFO -   Normalize: False
2025-07-28 05:05:27,804 - INFO -   Shards: 2
2025-07-28 05:05:27,804 - INFO -   Estimated samples: 5,219
2025-07-28 05:05:27,804 - INFO - CLIP reproduction dataloaders created successfully
2025-07-28 05:05:27,804 - INFO -   Training dataset length: 5,219
2025-07-28 05:05:27,804 - INFO -   Evaluation dataset length: 5,219
2025-07-28 05:05:27,804 - INFO - Dataloaders created
2025-07-28 05:05:27,804 - INFO -   Training batches: 326
2025-07-28 05:05:27,804 - INFO -   Evaluation available: True
2025-07-28 05:05:27,804 - INFO -   ğŸš« Normalization disabled in dataloaders
2025-07-28 05:05:27,805 - WARNING - Failed to import from blip3o_trainer.py: No module named 'blip3o_trainer'
2025-07-28 05:05:27,805 - INFO - âœ… Imported trainer from src.modules
2025-07-28 05:05:27,808 - INFO - Got exact dataloader length: 326
2025-07-28 05:05:27,809 - INFO - Optimizer and scheduler setup complete
2025-07-28 05:05:27,809 - INFO -   Total estimated steps: 3260
2025-07-28 05:05:27,809 - INFO -   Warmup steps: 100
2025-07-28 05:05:29,387 - INFO - âœ… WandB initialized: blip3o-clip-reproduction
2025-07-28 05:05:29,387 - INFO -    Run ID: o69vr3xh
2025-07-28 05:05:29,388 - INFO -    Run URL: https://wandb.ai/Eva-Clip/blip3o-clip-reproduction/runs/o69vr3xh
2025-07-28 05:05:29,388 - INFO - Preparing overfitting test with 20 samples...
2025-07-28 05:05:33,781 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:05:33,860 - INFO - Overfitting test prepared with 16 samples
2025-07-28 05:05:33,860 - INFO - BLIP3-o CLIP Trainer initialized
2025-07-28 05:05:33,860 - INFO -   Device: cuda
2025-07-28 05:05:33,860 - INFO -   Learning rate: 0.0005
2025-07-28 05:05:33,860 - INFO -   Epochs: 10
2025-07-28 05:05:33,860 - INFO -   Estimated steps per epoch: 326
2025-07-28 05:05:33,860 - INFO -   Overfit test: 20
2025-07-28 05:05:33,860 - INFO -   Mixed precision: True
2025-07-28 05:05:33,860 - INFO -   WandB logging: True
2025-07-28 05:05:33,861 - INFO -   ğŸš« Minimal normalization: Only for evaluation similarity
2025-07-28 05:05:33,861 - INFO - Trainer created with WandB integration
2025-07-28 05:05:33,861 - INFO -   ğŸ“Š WandB enabled: True
2025-07-28 05:05:33,861 - INFO -   ğŸ“Š WandB project: blip3o-clip-reproduction
2025-07-28 05:05:33,861 - INFO -   ğŸ“Š WandB run name: blip3o_base_patch_only_3drope_sandwich_20250728_050527
2025-07-28 05:05:33,861 - INFO -   ğŸ“Š WandB tags: ['blip3o', 'clip_reproduction', 'eva_conditioning', '3d_rope', 'sandwich_norm', 'overfit_test']
2025-07-28 05:05:33,863 - INFO - Configuration saved to checkpoints/clip_repro_20250728_050519/experiment_config.json
2025-07-28 05:05:33,863 - INFO - 
ğŸš€ Starting BLIP3-o training with advanced features...
2025-07-28 05:05:33,863 - INFO - Expected behavior:
2025-07-28 05:05:33,863 - INFO -   â€¢ Loss should decrease steadily
2025-07-28 05:05:33,863 - INFO -   â€¢ Velocity similarity should increase
2025-07-28 05:05:33,863 - INFO -   â€¢ CLIP similarity should improve during evaluation
2025-07-28 05:05:33,863 - INFO -   â€¢ Gradients should be non-zero and stable
2025-07-28 05:05:33,863 - INFO -   â€¢ Raw embeddings will be learned (no forced normalization)
2025-07-28 05:05:33,863 - INFO -   â€¢ 3D RoPE should provide spatial understanding
2025-07-28 05:05:33,864 - INFO -   â€¢ Sandwich normalization should improve gradient flow
2025-07-28 05:05:33,864 - INFO -   â€¢ WandB should log comprehensive metrics
2025-07-28 05:05:33,864 - INFO -   â€¢ OVERFITTING TEST: Should achieve >0.8 similarity on 20 samples
2025-07-28 05:05:33,864 - INFO - 
2025-07-28 05:05:33,864 - INFO - Starting CLIP reproduction training with WandB...
2025-07-28 05:05:33,865 - INFO -   Model parameters: 249,339,136
2025-07-28 05:05:33,865 - INFO -   Estimated training steps per epoch: 326
2025-07-28 05:05:33,865 - INFO -   Total estimated training steps: 3260
2025-07-28 05:05:33,865 - INFO -   ğŸš« Minimal normalization: Only for evaluation similarity
2025-07-28 05:05:33,865 - INFO -   ğŸ“Š WandB logging: True
2025-07-28 05:05:33,865 - INFO -   OVERFITTING TEST MODE: Using 16 samples
2025-07-28 05:05:33,868 - INFO - Starting epoch 1/10
2025-07-28 05:05:38,028 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:05:43,374 - INFO - Step 10: Loss=1.832526, VelSim=0.3591 (fair), GradNorm=24106.303, LR=9.50e-05, PredNorm=13.215, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:05:47,337 - INFO - Step 20: Loss=1.742845, VelSim=0.3978 (fair), GradNorm=30129.384, LR=1.40e-04, PredNorm=15.825, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:05:51,193 - INFO - Step 30: Loss=1.667959, VelSim=0.4228 (fair), GradNorm=16663.277, LR=1.85e-04, PredNorm=18.310, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:05:55,046 - INFO - Step 40: Loss=1.590864, VelSim=0.4352 (fair), GradNorm=34703.601, LR=2.30e-04, PredNorm=19.930, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:05:58,882 - INFO - Step 50: Loss=1.510960, VelSim=0.4180 (fair), GradNorm=81943.532, LR=2.75e-04, PredNorm=22.550, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:05:58,882 - INFO - Running evaluation at step 50...
2025-07-28 05:06:03,895 - INFO - Loaded shard 1/2: 2646 samples
2025-07-28 05:09:55,566 - INFO - Evaluation results (similarity uses normalization):
2025-07-28 05:09:55,569 - INFO -   eval_clip_similarity: 0.2143
2025-07-28 05:09:55,569 - INFO -   eval_clip_similarity_std: 0.0146
2025-07-28 05:09:55,569 - INFO -   eval_clip_similarity_min: 0.1682
2025-07-28 05:09:55,569 - INFO -   eval_clip_similarity_max: 0.2607
2025-07-28 05:09:55,569 - INFO -   eval_mse_loss: 1.8177
2025-07-28 05:09:55,569 - INFO -   eval_mse_loss_std: 0.1250
2025-07-28 05:09:55,570 - INFO -   eval_high_quality: 0.0000
2025-07-28 05:09:55,570 - INFO -   eval_very_high_quality: 0.0000
2025-07-28 05:09:55,570 - INFO -   eval_excellent_quality: 0.0000
2025-07-28 05:09:55,570 - INFO -   eval_samples: 512.0000
2025-07-28 05:09:55,570 - INFO -   eval_time_seconds: 236.6820
2025-07-28 05:09:55,570 - INFO -   eval_samples_per_second: 2.1632
2025-07-28 05:09:59,531 - INFO - Step 60: Loss=1.403242, VelSim=0.4363 (fair), GradNorm=68459.575, LR=3.20e-04, PredNorm=22.071, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:10:03,366 - INFO - Step 70: Loss=1.336556, VelSim=0.4609 (fair), GradNorm=31737.275, LR=3.65e-04, PredNorm=20.459, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:10:07,194 - INFO - Step 80: Loss=1.295531, VelSim=0.4815 (fair), GradNorm=38785.036, LR=4.10e-04, PredNorm=22.749, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:10:11,272 - INFO - Step 90: Loss=1.186697, VelSim=0.5400 (good), GradNorm=36219.118, LR=4.55e-04, PredNorm=23.108, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:10:15,108 - INFO - Step 100: Loss=1.057451, VelSim=0.6073 (good), GradNorm=52525.439, LR=5.00e-04, PredNorm=26.709, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:10:15,108 - INFO - Running evaluation at step 100...
2025-07-28 05:10:19,969 - INFO - Loaded shard 1/2: 2646 samples
2025-07-28 05:14:10,328 - INFO - Evaluation results (similarity uses normalization):
2025-07-28 05:14:10,331 - INFO -   eval_clip_similarity: 0.2289
2025-07-28 05:14:10,331 - INFO -   eval_clip_similarity_std: 0.0180
2025-07-28 05:14:10,331 - INFO -   eval_clip_similarity_min: 0.1774
2025-07-28 05:14:10,331 - INFO -   eval_clip_similarity_max: 0.2818
2025-07-28 05:14:10,331 - INFO -   eval_mse_loss: 1.9195
2025-07-28 05:14:10,331 - INFO -   eval_mse_loss_std: 0.1057
2025-07-28 05:14:10,331 - INFO -   eval_high_quality: 0.0000
2025-07-28 05:14:10,331 - INFO -   eval_very_high_quality: 0.0000
2025-07-28 05:14:10,331 - INFO -   eval_excellent_quality: 0.0000
2025-07-28 05:14:10,331 - INFO -   eval_samples: 512.0000
2025-07-28 05:14:10,331 - INFO -   eval_time_seconds: 235.2181
2025-07-28 05:14:10,331 - INFO -   eval_samples_per_second: 2.1767
2025-07-28 05:14:14,166 - INFO - Step 110: Loss=0.911443, VelSim=0.6768 (good), GradNorm=62080.628, LR=5.00e-04, PredNorm=28.682, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:14:18,014 - INFO - Step 120: Loss=0.704363, VelSim=0.7637 (good), GradNorm=43076.193, LR=5.00e-04, PredNorm=32.807, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:14:21,865 - INFO - Step 130: Loss=0.575600, VelSim=0.8141 (excellent), GradNorm=31733.536, LR=5.00e-04, PredNorm=34.982, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:14:25,687 - INFO - Step 140: Loss=0.438131, VelSim=0.8635 (excellent), GradNorm=20357.341, LR=5.00e-04, PredNorm=37.207, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:14:29,527 - INFO - Step 150: Loss=0.372438, VelSim=0.8875 (excellent), GradNorm=39777.209, LR=5.00e-04, PredNorm=38.539, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:14:29,527 - INFO - Running evaluation at step 150...
2025-07-28 05:14:34,595 - INFO - Loaded shard 1/2: 2646 samples
2025-07-28 05:18:24,826 - INFO - Evaluation results (similarity uses normalization):
2025-07-28 05:18:24,827 - INFO -   eval_clip_similarity: 0.2193
2025-07-28 05:18:24,827 - INFO -   eval_clip_similarity_std: 0.0160
2025-07-28 05:18:24,827 - INFO -   eval_clip_similarity_min: 0.1775
2025-07-28 05:18:24,827 - INFO -   eval_clip_similarity_max: 0.2687
2025-07-28 05:18:24,827 - INFO -   eval_mse_loss: 2.2564
2025-07-28 05:18:24,827 - INFO -   eval_mse_loss_std: 0.0981
2025-07-28 05:18:24,827 - INFO -   eval_high_quality: 0.0000
2025-07-28 05:18:24,827 - INFO -   eval_very_high_quality: 0.0000
2025-07-28 05:18:24,827 - INFO -   eval_excellent_quality: 0.0000
2025-07-28 05:18:24,827 - INFO -   eval_samples: 512.0000
2025-07-28 05:18:24,828 - INFO -   eval_time_seconds: 235.2961
2025-07-28 05:18:24,828 - INFO -   eval_samples_per_second: 2.1760
2025-07-28 05:18:27,201 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:18:27,201 - INFO - Epoch 1 completed:
2025-07-28 05:18:27,201 - INFO -   Average loss: 1.184380
2025-07-28 05:18:27,201 - INFO -   Best loss: 0.327288
2025-07-28 05:18:27,201 - INFO -   Best similarity: 0.9006
2025-07-28 05:18:27,201 - INFO -   Steps in epoch: 158
2025-07-28 05:18:27,201 - INFO -   Epoch time: 773.3s
2025-07-28 05:18:27,201 - INFO - Starting epoch 2/10
2025-07-28 05:18:31,839 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:18:32,145 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:18:32,145 - INFO - Epoch 2 completed:
2025-07-28 05:18:32,145 - INFO -   Average loss: 0.318013
2025-07-28 05:18:32,145 - INFO -   Best loss: 0.318013
2025-07-28 05:18:32,145 - INFO -   Best similarity: 0.9034
2025-07-28 05:18:32,145 - INFO -   Steps in epoch: 1
2025-07-28 05:18:32,145 - INFO -   Epoch time: 4.9s
2025-07-28 05:18:32,145 - INFO - Starting epoch 3/10
2025-07-28 05:18:36,293 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:18:37,436 - INFO - Step 160: Loss=0.310562, VelSim=0.9058 (excellent), GradNorm=24677.109, LR=5.00e-04, PredNorm=38.670, TargetNorm=42.453 [OVERFIT TEST]
2025-07-28 05:18:37,436 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:18:37,436 - INFO - Epoch 3 completed:
2025-07-28 05:18:37,436 - INFO -   Average loss: 0.310562
2025-07-28 05:18:37,437 - INFO -   Best loss: 0.310562
2025-07-28 05:18:37,437 - INFO -   Best similarity: 0.9058
2025-07-28 05:18:37,437 - INFO -   Steps in epoch: 1
2025-07-28 05:18:37,437 - INFO -   Epoch time: 5.3s
2025-07-28 05:18:37,437 - INFO - Starting epoch 4/10
2025-07-28 05:18:41,601 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:18:41,903 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:18:41,903 - INFO - Epoch 4 completed:
2025-07-28 05:18:41,903 - INFO -   Average loss: 0.302507
2025-07-28 05:18:41,903 - INFO -   Best loss: 0.302507
2025-07-28 05:18:41,904 - INFO -   Best similarity: 0.9083
2025-07-28 05:18:41,904 - INFO -   Steps in epoch: 1
2025-07-28 05:18:41,904 - INFO -   Epoch time: 4.5s
2025-07-28 05:18:41,904 - INFO - Starting epoch 5/10
2025-07-28 05:18:45,876 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:18:46,173 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:18:46,173 - INFO - Epoch 5 completed:
2025-07-28 05:18:46,173 - INFO -   Average loss: 0.296770
2025-07-28 05:18:46,174 - INFO -   Best loss: 0.296770
2025-07-28 05:18:46,174 - INFO -   Best similarity: 0.9101
2025-07-28 05:18:46,174 - INFO -   Steps in epoch: 1
2025-07-28 05:18:46,174 - INFO -   Epoch time: 4.3s
2025-07-28 05:18:46,174 - INFO - Starting epoch 6/10
2025-07-28 05:18:50,193 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:18:50,489 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:18:50,490 - INFO - Epoch 6 completed:
2025-07-28 05:18:50,490 - INFO -   Average loss: 0.291316
2025-07-28 05:18:50,490 - INFO -   Best loss: 0.291316
2025-07-28 05:18:50,491 - INFO -   Best similarity: 0.9118
2025-07-28 05:18:50,491 - INFO -   Steps in epoch: 1
2025-07-28 05:18:50,491 - INFO -   Epoch time: 4.3s
2025-07-28 05:18:50,491 - INFO - Starting epoch 7/10
2025-07-28 05:18:54,460 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:18:54,760 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:18:54,761 - INFO - Epoch 7 completed:
2025-07-28 05:18:54,761 - INFO -   Average loss: 0.285377
2025-07-28 05:18:54,761 - INFO -   Best loss: 0.285377
2025-07-28 05:18:54,761 - INFO -   Best similarity: 0.9137
2025-07-28 05:18:54,761 - INFO -   Steps in epoch: 1
2025-07-28 05:18:54,761 - INFO -   Epoch time: 4.3s
2025-07-28 05:18:54,761 - INFO - Starting epoch 8/10
2025-07-28 05:18:58,761 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:18:59,060 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:18:59,061 - INFO - Epoch 8 completed:
2025-07-28 05:18:59,061 - INFO -   Average loss: 0.280923
2025-07-28 05:18:59,061 - INFO -   Best loss: 0.280923
2025-07-28 05:18:59,061 - INFO -   Best similarity: 0.9151
2025-07-28 05:18:59,061 - INFO -   Steps in epoch: 1
2025-07-28 05:18:59,061 - INFO -   Epoch time: 4.3s
2025-07-28 05:18:59,061 - INFO - Starting epoch 9/10
2025-07-28 05:19:03,033 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:19:03,335 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:19:03,335 - INFO - Epoch 9 completed:
2025-07-28 05:19:03,335 - INFO -   Average loss: 0.276529
2025-07-28 05:19:03,336 - INFO -   Best loss: 0.276529
2025-07-28 05:19:03,336 - INFO -   Best similarity: 0.9164
2025-07-28 05:19:03,336 - INFO -   Steps in epoch: 1
2025-07-28 05:19:03,336 - INFO -   Epoch time: 4.3s
2025-07-28 05:19:03,336 - INFO - Starting epoch 10/10
2025-07-28 05:19:07,321 - INFO - Loaded shard 1/2: 2601 samples
2025-07-28 05:19:07,620 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-28 05:19:07,620 - INFO - Epoch 10 completed:
2025-07-28 05:19:07,620 - INFO -   Average loss: 0.271709
2025-07-28 05:19:07,620 - INFO -   Best loss: 0.271709
2025-07-28 05:19:07,620 - INFO -   Best similarity: 0.9179
2025-07-28 05:19:07,621 - INFO -   Steps in epoch: 1
2025-07-28 05:19:07,621 - INFO -   Epoch time: 4.3s
2025-07-28 05:19:09,310 - INFO - Checkpoint saved: checkpoints/clip_repro_20250728_050519/checkpoint_step_167.pt
2025-07-28 05:19:09,311 - INFO - Running final evaluation...
2025-07-28 05:19:13,613 - INFO - Loaded shard 1/2: 2646 samples
2025-07-28 05:26:49,386 - INFO - Training completed!
2025-07-28 05:26:49,388 - INFO -   Total time: 1273.7 seconds
2025-07-28 05:26:49,388 - INFO -   Total steps: 167
2025-07-28 05:26:49,388 - INFO -   Best loss: 0.271709
2025-07-28 05:26:49,388 - INFO -   Best CLIP similarity: 0.9179
2025-07-28 05:26:49,388 - INFO -   ğŸš« Used minimal normalization approach
2025-07-28 05:26:49,388 - INFO -   ğŸ“Š WandB run: True
2025-07-28 05:26:49,388 - INFO -   Final evaluation:
2025-07-28 05:26:49,388 - INFO -     eval_clip_similarity: 0.2262
2025-07-28 05:26:49,388 - INFO -     eval_clip_similarity_std: 0.0169
2025-07-28 05:26:49,389 - INFO -     eval_clip_similarity_min: 0.1814
2025-07-28 05:26:49,389 - INFO -     eval_clip_similarity_max: 0.2791
2025-07-28 05:26:49,389 - INFO -     eval_mse_loss: 2.2871
2025-07-28 05:26:49,389 - INFO -     eval_mse_loss_std: 0.0940
2025-07-28 05:26:49,389 - INFO -     eval_high_quality: 0.0000
2025-07-28 05:26:49,389 - INFO -     eval_very_high_quality: 0.0000
2025-07-28 05:26:49,389 - INFO -     eval_excellent_quality: 0.0000
2025-07-28 05:26:49,389 - INFO -     eval_samples: 1008.0000
2025-07-28 05:26:49,389 - INFO -     eval_time_seconds: 458.2212
2025-07-28 05:26:49,389 - INFO -     eval_samples_per_second: 2.1998
2025-07-28 05:26:49,389 - INFO -   Overfitting test: âœ… PASSED
2025-07-28 05:26:49,392 - INFO - 
================================================================================
2025-07-28 05:26:49,392 - INFO - ğŸ‰ BLIP3-o TRAINING COMPLETED!
2025-07-28 05:26:49,392 - INFO - ================================================================================
2025-07-28 05:26:49,392 - INFO - ğŸ“Š RESULTS SUMMARY:
2025-07-28 05:26:49,393 - INFO -   Duration: 1275.5 seconds (21.3 minutes)
2025-07-28 05:26:49,393 - INFO -   Total steps: 167
2025-07-28 05:26:49,393 - INFO -   Best loss: 0.271709
2025-07-28 05:26:49,393 - INFO -   Best CLIP similarity: 0.9179
2025-07-28 05:26:49,393 - INFO -   ğŸš« Used minimal normalization approach
2025-07-28 05:26:49,393 - INFO -   ğŸŒ 3D RoPE: âœ…
2025-07-28 05:26:49,393 - INFO -   ğŸ¥ª Sandwich Norm: âœ…
2025-07-28 05:26:49,393 - INFO -   ğŸ“Š WandB: âœ…
2025-07-28 05:26:49,393 - INFO - ğŸ“Š FINAL EVALUATION:
2025-07-28 05:26:49,393 - INFO -   CLIP similarity: 0.2262
2025-07-28 05:26:49,393 - INFO -   High quality (>0.7): 0.0%
2025-07-28 05:26:49,393 - INFO -   Very high quality (>0.8): 0.0%
2025-07-28 05:26:49,393 - INFO -   Excellent quality (>0.9): 0.0%
2025-07-28 05:26:49,393 - INFO -   Samples evaluated: 1008
2025-07-28 05:26:49,393 - INFO - ğŸ§ª OVERFITTING TEST: âœ… PASSED
2025-07-28 05:26:49,393 - INFO -    âœ… Model can learn and memorize - BLIP3-o architecture is working!
2025-07-28 05:26:49,393 - INFO - ğŸ—ï¸  BLIP3-o ARCHITECTURE ASSESSMENT:
2025-07-28 05:26:49,393 - INFO -    ğŸ‰ EXCELLENT: BLIP3-o DiT with 3D RoPE + Sandwich Norm working perfectly!
2025-07-28 05:26:49,393 - INFO - ğŸ“Š WandB Dashboard: Check your blip3o-clip-reproduction project for detailed metrics
2025-07-28 05:26:49,394 - INFO - ğŸ“ Final summary saved to checkpoints/clip_repro_20250728_050519/final_summary.json
2025-07-28 05:26:49,394 - INFO - ğŸ“ Model checkpoints saved to checkpoints/clip_repro_20250728_050519
2025-07-28 05:26:49,394 - INFO - ================================================================================
