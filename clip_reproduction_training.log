2025-07-31 22:36:22,726 - INFO - ğŸš€ Starting CLIP Reproduction with BLIP3-o DiT
2025-07-31 22:36:22,726 - INFO - ================================================================================
2025-07-31 22:36:22,726 - INFO - EXPERIMENT DETAILS:
2025-07-31 22:36:22,726 - INFO -   ğŸ“‹ Task: Reproduce clean CLIP embeddings from EVA embeddings
2025-07-31 22:36:22,726 - INFO -   ğŸ§  Model: BLIP3-o DiT with advanced architecture features
2025-07-31 22:36:22,726 - INFO -   ğŸ¯ Target: CLIP embeddings [B, N, 1024]
2025-07-31 22:36:22,726 - INFO -   ğŸ® Conditioning: EVA embeddings [B, N, 4096]
2025-07-31 22:36:22,726 - INFO -   ğŸŒŠ Method: Rectified Flow Matching
2025-07-31 22:36:22,726 - INFO -   ğŸš« Normalization: MINIMAL (only for evaluation similarity)
2025-07-31 22:36:22,726 - INFO - ================================================================================
2025-07-31 22:36:22,726 - INFO - ğŸ—ï¸ BLIP3-o ARCHITECTURE FEATURES:
2025-07-31 22:36:22,726 - INFO -   ğŸŒ 3D Rotary Position Embedding: âœ… ENABLED
2025-07-31 22:36:22,726 - INFO -   ğŸ¥ª Sandwich Normalization: âœ… ENABLED
2025-07-31 22:36:22,726 - INFO -   ğŸ” Grouped-Query Attention: âœ… ENABLED
2025-07-31 22:36:22,726 - INFO -   ğŸ“Š WandB Logging: âœ… ENABLED
2025-07-31 22:36:22,726 - INFO - ================================================================================
2025-07-31 22:36:22,726 - INFO - ğŸ“„ Updated file structure:
2025-07-31 22:36:22,726 - INFO -   â€¢ Model: blip3o_dit.py (âœ… 3D RoPE + Sandwich Norm)
2025-07-31 22:36:22,726 - INFO -   â€¢ Loss: blip3o_fm_loss.py
2025-07-31 22:36:22,726 - INFO -   â€¢ Dataset: blip3o_datasets.py
2025-07-31 22:36:22,726 - INFO -   â€¢ Trainer: blip3o_trainer.py (âœ… WandB Integration)
2025-07-31 22:36:22,729 - INFO -   â€¢ Config: blip3o_config.py
2025-07-31 22:36:22,729 - INFO - ================================================================================
2025-07-31 22:36:22,729 - INFO - Configuration:
2025-07-31 22:36:22,729 - INFO -   Model size: base
2025-07-31 22:36:22,729 - INFO -   Training mode: patch_only
2025-07-31 22:36:22,729 - INFO -   Embeddings dir: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-07-31 22:36:22,729 - INFO -   Output dir: ./checkpoints/clip_repro_20250731_223619
2025-07-31 22:36:22,729 - INFO -   Learning rate: 0.0005
2025-07-31 22:36:22,729 - INFO -   Batch size: 8
2025-07-31 22:36:22,729 - INFO -   Epochs: 10
2025-07-31 22:36:22,729 - INFO -   Max shards: 2
2025-07-31 22:36:22,729 - INFO -   ğŸ§ª OVERFITTING TEST: 20 samples
2025-07-31 22:36:22,729 - INFO -   Debug mode: False
2025-07-31 22:36:22,729 - INFO -   ğŸ“Š WandB project: blip3o-clip-reproduction
2025-07-31 22:36:22,729 - INFO - ================================================================================
2025-07-31 22:36:22,729 - INFO - ğŸ” Checking module availability...
2025-07-31 22:36:31,236 - INFO - âœ… CLIP DiT model loaded from src/modules/models/blip3o_dit.py
2025-07-31 22:36:31,246 - INFO - âœ… Flow matching loss loaded from src/modules/losses/blip3o_fm_loss.py
2025-07-31 22:36:32,945 - INFO - âœ… CLIP trainer loaded from src/modules/trainers/blip3o_trainer.py
2025-07-31 22:36:32,949 - INFO - âœ… CLIP datasets loaded from src/modules/datasets/blip3o_dataset.py
2025-07-31 22:36:32,954 - INFO - âœ… Configuration loaded from src/modules/config/blip3o_config.py
2025-07-31 22:36:32,954 - INFO - ğŸ‰ All CLIP reproduction components loaded successfully!
2025-07-31 22:36:32,954 - INFO - ğŸ‰ BLIP3-o CLIP reproduction modules fully initialized!
2025-07-31 22:36:32,954 - INFO - ğŸš« Using minimal normalization approach
2025-07-31 22:36:32,954 - INFO - ğŸ¯ Ready for EVA â†’ CLIP reproduction training
2025-07-31 22:36:32,954 - INFO - âœ… Using comprehensive modules system
2025-07-31 22:36:32,955 - INFO - ğŸ‰ All CLIP reproduction components loaded successfully!
2025-07-31 22:36:32,955 - INFO - ğŸ‰ All CLIP reproduction components loaded successfully!
2025-07-31 22:36:32,955 - INFO - âœ… Imported config from src.modules
2025-07-31 22:36:33,222 - INFO - Using GPU: NVIDIA H100
2025-07-31 22:36:33,223 - INFO - GPU Memory: 100.0 GB
2025-07-31 22:36:33,223 - INFO - ğŸ—ï¸ BLIP3-o Architecture Configuration:
2025-07-31 22:36:33,223 - INFO -   3D Rotary Position Embedding: âœ… Enabled
2025-07-31 22:36:33,223 - INFO -   Sandwich Normalization: âœ… Enabled
2025-07-31 22:36:33,223 - WARNING - Failed to import from blip3o_dit.py: No module named 'blip3o_dit'
2025-07-31 22:36:33,223 - INFO - âœ… Imported model from src.modules
2025-07-31 22:36:35,241 - INFO - BLIP3-o CLIP DiT model initialized with 249,339,136 parameters
2025-07-31 22:36:35,242 - INFO -   3D RoPE: True
2025-07-31 22:36:35,242 - INFO -   Sandwich Normalization: True
2025-07-31 22:36:35,242 - INFO -   Grid size: 16x16
2025-07-31 22:36:35,242 - INFO -   Hidden size: 768
2025-07-31 22:36:35,242 - INFO -   CLIP size: 1024
2025-07-31 22:36:35,242 - INFO - Creating base model for patch_only mode...
2025-07-31 22:36:35,480 - INFO - Model created with 249,339,136 parameters
2025-07-31 22:36:35,481 - INFO - Model moved to cuda
2025-07-31 22:36:35,481 - INFO - ğŸ” Architecture Validation:
2025-07-31 22:36:35,481 - INFO -   3D RoPE: âœ…
2025-07-31 22:36:35,481 - INFO -   Sandwich Norm: âœ…
2025-07-31 22:36:35,481 - INFO -   Grid Size: 16x16
2025-07-31 22:36:35,481 - INFO -   Grouped-Query Attention: 12/4
2025-07-31 22:36:35,481 - WARNING - Failed to import from blip3o_fm_loss.py: No module named 'blip3o_fm_loss'
2025-07-31 22:36:35,481 - INFO - âœ… Imported loss from src.modules
2025-07-31 22:36:35,481 - INFO - CLIP Flow Matching Loss initialized with noise scaling:
2025-07-31 22:36:35,481 - INFO -   Prediction type: velocity
2025-07-31 22:36:35,481 - INFO -   Flow type: rectified
2025-07-31 22:36:35,481 - INFO -   Adaptive noise scaling: True
2025-07-31 22:36:35,481 - INFO -   Debug mode: False
2025-07-31 22:36:35,481 - INFO - Flow matching loss created
2025-07-31 22:36:35,481 - WARNING - Failed to import from blip3o_datasets.py: No module named 'blip3o_datasets'
2025-07-31 22:36:35,482 - INFO - âœ… Imported dataset from src.modules
2025-07-31 22:36:35,482 - INFO - Creating CLIP reproduction dataloaders:
2025-07-31 22:36:35,482 - INFO -   Target: CLIP embeddings [B, N, 1024]
2025-07-31 22:36:35,482 - INFO -   Conditioning: EVA embeddings [B, N, 4096]
2025-07-31 22:36:35,482 - INFO -   Normalize: False
2025-07-31 22:36:35,482 - INFO -   ğŸ¯ COLLECT STATISTICS: True (for noise scaling)
2025-07-31 22:36:35,519 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-07-31 22:36:35,520 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-07-31 22:36:35,540 - INFO - Prepared 2 shard files
2025-07-31 22:36:35,540 - INFO - Using manifest for length estimation: 5,219 samples
2025-07-31 22:36:35,540 - INFO - CLIP Reproduction Dataset initialized:
2025-07-31 22:36:35,540 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-07-31 22:36:35,540 - INFO -   Mode: patch_only (256 tokens)
2025-07-31 22:36:35,540 - INFO -   TARGET: CLIP embeddings [B, N, 1024]
2025-07-31 22:36:35,540 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-07-31 22:36:35,540 - INFO -   Normalize: False
2025-07-31 22:36:35,540 - INFO -   Shards: 2
2025-07-31 22:36:35,540 - INFO -   Estimated samples: 5,219
2025-07-31 22:36:35,541 - INFO -   ğŸ¯ COLLECT STATISTICS: True (for noise scaling)
2025-07-31 22:36:35,541 - INFO - Loaded manifest: 35 shards, 91,333 samples
2025-07-31 22:36:35,541 - INFO - Found 35 files with pattern: embeddings_shard_*_patch_only.pkl
2025-07-31 22:36:35,541 - INFO - Prepared 2 shard files
2025-07-31 22:36:35,541 - INFO - Using manifest for length estimation: 5,219 samples
2025-07-31 22:36:35,541 - INFO - CLIP Reproduction Dataset initialized:
2025-07-31 22:36:35,541 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-07-31 22:36:35,542 - INFO -   Mode: patch_only (256 tokens)
2025-07-31 22:36:35,542 - INFO -   TARGET: CLIP embeddings [B, N, 1024]
2025-07-31 22:36:35,542 - INFO -   CONDITIONING: EVA embeddings [B, N, 4096]
2025-07-31 22:36:35,542 - INFO -   Normalize: False
2025-07-31 22:36:35,542 - INFO -   Shards: 2
2025-07-31 22:36:35,542 - INFO -   Estimated samples: 5,219
2025-07-31 22:36:35,542 - INFO -   ğŸ¯ COLLECT STATISTICS: False (for noise scaling)
2025-07-31 22:36:35,542 - INFO - CLIP reproduction dataloaders created successfully
2025-07-31 22:36:35,542 - INFO -   Training dataset length: 5,219
2025-07-31 22:36:35,542 - INFO -   Evaluation dataset length: 5,219
2025-07-31 22:36:39,974 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:36:40,011 - INFO -   ğŸ“Š Initial data statistics:
2025-07-31 22:36:40,011 - INFO -     CLIP norm: 26.319 Â± 2.018
2025-07-31 22:36:40,011 - INFO -     CLIP std: 0.979
2025-07-31 22:36:40,011 - INFO -     EVA norm: 43.667 Â± 1.968
2025-07-31 22:36:40,011 - INFO -     Samples seen: 2601
2025-07-31 22:36:40,011 - INFO - Dataloaders created
2025-07-31 22:36:40,011 - INFO -   Training batches: 652
2025-07-31 22:36:40,011 - INFO -   Evaluation available: True
2025-07-31 22:36:40,011 - INFO -   ğŸš« Normalization disabled in dataloaders
2025-07-31 22:36:40,012 - WARNING - Failed to import from blip3o_trainer.py: No module named 'blip3o_trainer'
2025-07-31 22:36:40,012 - INFO - âœ… Imported trainer from src.modules
2025-07-31 22:36:40,015 - INFO - Got exact dataloader length: 652
2025-07-31 22:36:40,016 - INFO - Optimizer and scheduler setup complete
2025-07-31 22:36:40,016 - INFO -   Total estimated steps: 6520
2025-07-31 22:36:40,016 - INFO -   Warmup steps: 100
2025-07-31 22:36:41,500 - INFO - âœ… WandB initialized: blip3o-clip-reproduction
2025-07-31 22:36:41,500 - INFO -    Run ID: ibgn0uh8
2025-07-31 22:36:41,500 - INFO -    Run URL: https://wandb.ai/Eva-Clip/blip3o-clip-reproduction/runs/ibgn0uh8
2025-07-31 22:36:41,500 - INFO - Preparing overfitting test with 20 samples...
2025-07-31 22:36:45,712 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:36:45,734 - INFO - Overfitting test prepared with 8 samples
2025-07-31 22:36:45,735 - INFO - BLIP3-o CLIP Trainer initialized with noise scaling
2025-07-31 22:36:45,735 - INFO -   Device: cuda
2025-07-31 22:36:45,735 - INFO -   Learning rate: 0.0005
2025-07-31 22:36:45,735 - INFO -   Epochs: 10
2025-07-31 22:36:45,735 - INFO -   Estimated steps per epoch: 652
2025-07-31 22:36:45,735 - INFO -   Noise scale sync every: 10 steps
2025-07-31 22:36:45,735 - INFO -   Generation debug: False
2025-07-31 22:36:45,735 - INFO -   Overfit test: 20
2025-07-31 22:36:45,735 - INFO -   Mixed precision: True
2025-07-31 22:36:45,735 - INFO -   WandB logging: True
2025-07-31 22:36:45,736 - INFO -   ğŸ¯ FIXED: Proper noise scaling between training and inference
2025-07-31 22:36:45,736 - INFO - Trainer created with WandB integration
2025-07-31 22:36:45,736 - INFO -   ğŸ“Š WandB enabled: True
2025-07-31 22:36:45,736 - INFO -   ğŸ“Š WandB project: blip3o-clip-reproduction
2025-07-31 22:36:45,736 - INFO -   ğŸ“Š WandB run name: blip3o_base_patch_only_3drope_sandwich_20250731_223640
2025-07-31 22:36:45,736 - INFO -   ğŸ“Š WandB tags: ['blip3o', 'clip_reproduction', 'eva_conditioning', '3d_rope', 'sandwich_norm', 'overfit_test']
2025-07-31 22:36:45,738 - INFO - Configuration saved to checkpoints/clip_repro_20250731_223619/experiment_config.json
2025-07-31 22:36:45,739 - INFO - 
ğŸš€ Starting BLIP3-o training with advanced features...
2025-07-31 22:36:45,739 - INFO - Expected behavior:
2025-07-31 22:36:45,739 - INFO -   â€¢ Loss should decrease steadily
2025-07-31 22:36:45,739 - INFO -   â€¢ Velocity similarity should increase
2025-07-31 22:36:45,739 - INFO -   â€¢ CLIP similarity should improve during evaluation
2025-07-31 22:36:45,739 - INFO -   â€¢ Gradients should be non-zero and stable
2025-07-31 22:36:45,739 - INFO -   â€¢ Raw embeddings will be learned (no forced normalization)
2025-07-31 22:36:45,739 - INFO -   â€¢ 3D RoPE should provide spatial understanding
2025-07-31 22:36:45,739 - INFO -   â€¢ Sandwich normalization should improve gradient flow
2025-07-31 22:36:45,739 - INFO -   â€¢ WandB should log comprehensive metrics
2025-07-31 22:36:45,739 - INFO -   â€¢ OVERFITTING TEST: Should achieve >0.8 similarity on 20 samples
2025-07-31 22:36:45,739 - INFO - 
2025-07-31 22:36:45,739 - INFO - Starting CLIP reproduction training with noise scaling...
2025-07-31 22:36:45,740 - INFO -   Model parameters: 249,339,136
2025-07-31 22:36:45,740 - INFO -   Estimated training steps per epoch: 652
2025-07-31 22:36:45,740 - INFO -   Total estimated training steps: 6520
2025-07-31 22:36:45,740 - INFO -   ğŸ¯ NOISE SCALING: Adaptive noise scaling enabled
2025-07-31 22:36:45,740 - INFO -   ğŸ¯ SYNC FREQUENCY: Every 10 steps
2025-07-31 22:36:45,741 - INFO -   ğŸ“Š WandB logging: True
2025-07-31 22:36:45,741 - INFO -   OVERFITTING TEST MODE: Using 8 samples
2025-07-31 22:36:45,743 - INFO - Starting epoch 1/10
2025-07-31 22:36:49,908 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:36:55,280 - INFO - Step 10: Loss=1.780620, VelSim=0.3538 (fair), GradNorm=21605.273, LR=9.50e-05, NoiseScale=0.909 (ratio=1.255), PredNorm=12.544, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:36:55,467 - INFO - Set model noise scale: 0.909
2025-07-31 22:36:59,009 - INFO - Step 20: Loss=1.712122, VelSim=0.3861 (fair), GradNorm=20301.715, LR=1.40e-04, NoiseScale=0.909 (ratio=1.255), PredNorm=15.936, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:36:59,196 - INFO - Set model noise scale: 0.909
2025-07-31 22:37:02,728 - INFO - Step 30: Loss=1.639963, VelSim=0.4234 (fair), GradNorm=26574.151, LR=1.85e-04, NoiseScale=0.909 (ratio=1.255), PredNorm=17.326, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:37:02,914 - INFO - Set model noise scale: 0.909
2025-07-31 22:37:06,451 - INFO - Step 40: Loss=1.524316, VelSim=0.4703 (fair), GradNorm=53947.068, LR=2.30e-04, NoiseScale=0.909 (ratio=1.255), PredNorm=20.034, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:37:06,637 - INFO - Set model noise scale: 0.909
2025-07-31 22:37:10,145 - INFO - Step 50: Loss=1.283254, VelSim=0.5640 (good), GradNorm=42279.039, LR=2.75e-04, NoiseScale=0.909 (ratio=1.255), PredNorm=23.952, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:37:10,145 - INFO - Running evaluation at step 50...
2025-07-31 22:37:14,505 - INFO - Loaded shard 1/2: 2646 samples
2025-07-31 22:37:29,240 - INFO - Evaluation results:
2025-07-31 22:37:29,242 - INFO -   CLIP similarity: 0.2403
2025-07-31 22:37:29,242 - INFO -   Generated norm: 34.480
2025-07-31 22:37:29,243 - INFO -   Target norm: 25.856
2025-07-31 22:37:29,243 - INFO -   Norm ratio: 1.334
2025-07-31 22:37:29,243 - INFO -   Noise scale used: 0.909
2025-07-31 22:37:29,428 - INFO - Set model noise scale: 0.909
2025-07-31 22:37:32,928 - INFO - Step 60: Loss=1.026192, VelSim=0.6474 (good), GradNorm=63120.538, LR=3.20e-04, NoiseScale=0.909 (ratio=1.255), PredNorm=26.571, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:37:33,114 - INFO - Set model noise scale: 0.909
2025-07-31 22:37:36,603 - INFO - Step 70: Loss=0.773123, VelSim=0.7323 (good), GradNorm=63942.411, LR=3.65e-04, NoiseScale=0.909 (ratio=1.255), PredNorm=29.871, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:37:36,790 - INFO - Set model noise scale: 0.909
2025-07-31 22:37:40,298 - INFO - Step 80: Loss=0.562481, VelSim=0.8142 (excellent), GradNorm=33254.587, LR=4.10e-04, NoiseScale=0.909 (ratio=1.255), PredNorm=34.031, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:37:40,485 - INFO - Set model noise scale: 0.909
2025-07-31 22:37:43,976 - INFO - Step 90: Loss=0.414902, VelSim=0.8669 (excellent), GradNorm=46204.180, LR=4.55e-04, NoiseScale=0.909 (ratio=1.255), PredNorm=37.007, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:37:44,162 - INFO - Set model noise scale: 0.909
2025-07-31 22:37:46,539 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:37:46,541 - INFO - Epoch 1 completed:
2025-07-31 22:37:46,541 - INFO -   Average loss: 1.195228
2025-07-31 22:37:46,541 - INFO -   Best loss: 0.317295
2025-07-31 22:37:46,541 - INFO -   Best similarity: 0.9003
2025-07-31 22:37:46,541 - INFO -   Steps in epoch: 99
2025-07-31 22:37:46,541 - INFO -   Epoch time: 60.8s
2025-07-31 22:37:46,542 - INFO -   Current noise scale: 0.909
2025-07-31 22:37:46,542 - INFO - Starting epoch 2/10
2025-07-31 22:37:51,026 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:37:52,158 - INFO - Step 100: Loss=0.309320, VelSim=0.9030 (excellent), GradNorm=29724.445, LR=5.00e-04, NoiseScale=0.909 (ratio=1.255), PredNorm=37.753, TargetNorm=41.503 [OVERFIT TEST]
2025-07-31 22:37:52,158 - INFO - Running evaluation at step 100...
2025-07-31 22:37:56,317 - INFO - Loaded shard 1/2: 2646 samples
2025-07-31 22:38:10,948 - INFO - Evaluation results:
2025-07-31 22:38:10,949 - INFO -   CLIP similarity: 0.2401
2025-07-31 22:38:10,949 - INFO -   Generated norm: 39.612
2025-07-31 22:38:10,949 - INFO -   Target norm: 25.856
2025-07-31 22:38:10,949 - INFO -   Norm ratio: 1.532
2025-07-31 22:38:10,949 - INFO -   Noise scale used: 0.909
2025-07-31 22:38:10,949 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:38:10,950 - INFO - Epoch 2 completed:
2025-07-31 22:38:10,950 - INFO -   Average loss: 0.309320
2025-07-31 22:38:10,950 - INFO -   Best loss: 0.309320
2025-07-31 22:38:10,950 - INFO -   Best similarity: 0.9030
2025-07-31 22:38:10,950 - INFO -   Steps in epoch: 1
2025-07-31 22:38:10,950 - INFO -   Epoch time: 24.4s
2025-07-31 22:38:10,950 - INFO -   Current noise scale: 0.909
2025-07-31 22:38:10,950 - INFO - Starting epoch 3/10
2025-07-31 22:38:15,161 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:38:15,349 - INFO - Set model noise scale: 0.909
2025-07-31 22:38:15,452 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:38:15,452 - INFO - Epoch 3 completed:
2025-07-31 22:38:15,452 - INFO -   Average loss: 0.301037
2025-07-31 22:38:15,453 - INFO -   Best loss: 0.301037
2025-07-31 22:38:15,453 - INFO -   Best similarity: 0.9059
2025-07-31 22:38:15,453 - INFO -   Steps in epoch: 1
2025-07-31 22:38:15,453 - INFO -   Epoch time: 4.5s
2025-07-31 22:38:15,453 - INFO -   Current noise scale: 0.909
2025-07-31 22:38:15,453 - INFO - Starting epoch 4/10
2025-07-31 22:38:19,570 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:38:19,856 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:38:19,857 - INFO - Epoch 4 completed:
2025-07-31 22:38:19,857 - INFO -   Average loss: 0.294942
2025-07-31 22:38:19,857 - INFO -   Best loss: 0.294942
2025-07-31 22:38:19,857 - INFO -   Best similarity: 0.9080
2025-07-31 22:38:19,857 - INFO -   Steps in epoch: 1
2025-07-31 22:38:19,857 - INFO -   Epoch time: 4.4s
2025-07-31 22:38:19,857 - INFO -   Current noise scale: 0.909
2025-07-31 22:38:19,857 - INFO - Starting epoch 5/10
2025-07-31 22:38:23,952 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:38:24,237 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:38:24,238 - INFO - Epoch 5 completed:
2025-07-31 22:38:24,238 - INFO -   Average loss: 0.287736
2025-07-31 22:38:24,238 - INFO -   Best loss: 0.287736
2025-07-31 22:38:24,238 - INFO -   Best similarity: 0.9103
2025-07-31 22:38:24,238 - INFO -   Steps in epoch: 1
2025-07-31 22:38:24,238 - INFO -   Epoch time: 4.4s
2025-07-31 22:38:24,238 - INFO -   Current noise scale: 0.909
2025-07-31 22:38:24,238 - INFO - Starting epoch 6/10
2025-07-31 22:38:28,388 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:38:28,675 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:38:28,675 - INFO - Epoch 6 completed:
2025-07-31 22:38:28,675 - INFO -   Average loss: 0.279455
2025-07-31 22:38:28,675 - INFO -   Best loss: 0.279455
2025-07-31 22:38:28,675 - INFO -   Best similarity: 0.9129
2025-07-31 22:38:28,675 - INFO -   Steps in epoch: 1
2025-07-31 22:38:28,675 - INFO -   Epoch time: 4.4s
2025-07-31 22:38:28,675 - INFO -   Current noise scale: 0.909
2025-07-31 22:38:28,675 - INFO - Starting epoch 7/10
2025-07-31 22:38:32,781 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:38:33,068 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:38:33,069 - INFO - Epoch 7 completed:
2025-07-31 22:38:33,069 - INFO -   Average loss: 0.271851
2025-07-31 22:38:33,069 - INFO -   Best loss: 0.271851
2025-07-31 22:38:33,069 - INFO -   Best similarity: 0.9155
2025-07-31 22:38:33,069 - INFO -   Steps in epoch: 1
2025-07-31 22:38:33,069 - INFO -   Epoch time: 4.4s
2025-07-31 22:38:33,070 - INFO -   Current noise scale: 0.909
2025-07-31 22:38:33,070 - INFO - Starting epoch 8/10
2025-07-31 22:38:40,853 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:38:41,143 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:38:41,143 - INFO - Epoch 8 completed:
2025-07-31 22:38:41,143 - INFO -   Average loss: 0.264161
2025-07-31 22:38:41,143 - INFO -   Best loss: 0.264161
2025-07-31 22:38:41,143 - INFO -   Best similarity: 0.9181
2025-07-31 22:38:41,143 - INFO -   Steps in epoch: 1
2025-07-31 22:38:41,143 - INFO -   Epoch time: 8.1s
2025-07-31 22:38:41,143 - INFO -   Current noise scale: 0.909
2025-07-31 22:38:41,144 - INFO - Starting epoch 9/10
2025-07-31 22:38:52,391 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:38:52,683 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:38:52,684 - INFO - Epoch 9 completed:
2025-07-31 22:38:52,684 - INFO -   Average loss: 0.256931
2025-07-31 22:38:52,684 - INFO -   Best loss: 0.256931
2025-07-31 22:38:52,684 - INFO -   Best similarity: 0.9205
2025-07-31 22:38:52,684 - INFO -   Steps in epoch: 1
2025-07-31 22:38:52,684 - INFO -   Epoch time: 11.5s
2025-07-31 22:38:52,684 - INFO -   Current noise scale: 0.909
2025-07-31 22:38:52,684 - INFO - Starting epoch 10/10
2025-07-31 22:39:09,156 - INFO - Loaded shard 1/2: 2601 samples
2025-07-31 22:39:09,441 - INFO - ğŸ‰ OVERFITTING TEST PASSED! Model can learn effectively.
2025-07-31 22:39:09,442 - INFO - Epoch 10 completed:
2025-07-31 22:39:09,442 - INFO -   Average loss: 0.250827
2025-07-31 22:39:09,442 - INFO -   Best loss: 0.250827
2025-07-31 22:39:09,442 - INFO -   Best similarity: 0.9223
2025-07-31 22:39:09,442 - INFO -   Steps in epoch: 1
2025-07-31 22:39:09,442 - INFO -   Epoch time: 16.8s
2025-07-31 22:39:09,442 - INFO -   Current noise scale: 0.909
2025-07-31 22:39:11,707 - INFO - Checkpoint saved: checkpoints/clip_repro_20250731_223619/checkpoint_step_108.pt
2025-07-31 22:39:11,707 - INFO - Running final evaluation...
2025-07-31 22:39:16,002 - INFO - Loaded shard 1/2: 2646 samples
2025-07-31 22:39:47,124 - INFO - Training completed!
2025-07-31 22:39:47,125 - INFO -   Total time: 179.6 seconds
2025-07-31 22:39:47,125 - INFO -   Total steps: 108
2025-07-31 22:39:47,125 - INFO -   Best loss: 0.250827
2025-07-31 22:39:47,125 - INFO -   Best CLIP similarity: 0.9223
2025-07-31 22:39:47,125 - INFO -   ğŸ¯ NOISE SCALING: Final scale = 0.909
2025-07-31 22:39:47,125 - INFO -   ğŸ“Š WandB run: True
2025-07-31 22:39:47,125 - INFO -   Final evaluation:
2025-07-31 22:39:47,125 - INFO -     CLIP similarity: 0.2447
2025-07-31 22:39:47,125 - INFO -     Generated norm: 40.139
2025-07-31 22:39:47,125 - INFO -     Target norm: 26.288
2025-07-31 22:39:47,125 - INFO -     Norm ratio: 1.527
2025-07-31 22:39:47,125 - INFO -   Overfitting test: âœ… PASSED
2025-07-31 22:39:47,128 - INFO - 
================================================================================
2025-07-31 22:39:47,129 - INFO - ğŸ‰ BLIP3-o TRAINING COMPLETED!
2025-07-31 22:39:47,129 - INFO - ================================================================================
2025-07-31 22:39:47,129 - INFO - ğŸ“Š RESULTS SUMMARY:
2025-07-31 22:39:47,129 - INFO -   Duration: 181.4 seconds (3.0 minutes)
2025-07-31 22:39:47,129 - INFO -   Total steps: 108
2025-07-31 22:39:47,129 - INFO -   Best loss: 0.250827
2025-07-31 22:39:47,129 - INFO -   Best CLIP similarity: 0.9223
2025-07-31 22:39:47,129 - INFO -   ğŸš« Used minimal normalization approach
2025-07-31 22:39:47,129 - INFO -   ğŸŒ 3D RoPE: âœ…
2025-07-31 22:39:47,129 - INFO -   ğŸ¥ª Sandwich Norm: âœ…
2025-07-31 22:39:47,129 - INFO -   ğŸ“Š WandB: âœ…
2025-07-31 22:39:47,129 - INFO - ğŸ“Š FINAL EVALUATION:
2025-07-31 22:39:47,129 - INFO -   CLIP similarity: 0.2447
2025-07-31 22:39:47,129 - INFO -   High quality (>0.7): 0.0%
2025-07-31 22:39:47,129 - INFO -   Very high quality (>0.8): 0.0%
2025-07-31 22:39:47,129 - INFO -   Excellent quality (>0.9): 0.0%
2025-07-31 22:39:47,129 - INFO -   Samples evaluated: 32
2025-07-31 22:39:47,129 - INFO - ğŸ§ª OVERFITTING TEST: âœ… PASSED
2025-07-31 22:39:47,130 - INFO -    âœ… Model can learn and memorize - BLIP3-o architecture is working!
2025-07-31 22:39:47,130 - INFO - ğŸ—ï¸  BLIP3-o ARCHITECTURE ASSESSMENT:
2025-07-31 22:39:47,130 - INFO -    ğŸ‰ EXCELLENT: BLIP3-o DiT with 3D RoPE + Sandwich Norm working perfectly!
2025-07-31 22:39:47,130 - INFO - ğŸ“Š WandB Dashboard: Check your blip3o-clip-reproduction project for detailed metrics
2025-07-31 22:39:47,131 - INFO - ğŸ“ Final summary saved to checkpoints/clip_repro_20250731_223619/final_summary.json
2025-07-31 22:39:47,131 - INFO - ğŸ“ Model checkpoints saved to checkpoints/clip_repro_20250731_223619
2025-07-31 22:39:47,131 - INFO - ================================================================================
